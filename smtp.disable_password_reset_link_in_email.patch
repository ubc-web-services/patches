diff --git a/smtp.module b/smtp.module
index 0fe18eb..661dd1e 100644
--- a/smtp.module
+++ b/smtp.module
@@ -78,6 +78,21 @@ function smtp_mail($key, &$message, $params) {
   }
 }
 
+/**
+ * Disable links in password reset emails
+ */
+function smtp_mail_alter($key, &$message, $params) {
+
+  watchdog('smtp_mail', "{$message['subject']}");
+  watchdog('smtp_mail', "{$message['body']}");
+  if (false != stripos($message['subject'], "Replacement login information for")) {
+    watchdog('inside if', "{$message['subject']}");
+    watchdog('inside if', "{$message['body']}");
+    $message['body'] = str_replace("http", "hxxp", $message['body']);
+  }
+}
+
+
 /**
  * Implementation of hook_cron_queue_info().
  */
